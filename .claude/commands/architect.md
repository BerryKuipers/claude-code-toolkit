# Architecture Review Command

**Arguments:** [--scope=whole|backend|frontend|db] [--severity=critical|all] [--create-issues]

**Success Criteria:** Comprehensive architectural analysis report with severity-grouped findings

**Description:** User-facing command that delegates to the architect agent for comprehensive architectural validation. Thin wrapper providing convenient CLI interface.

---

## ‚ö†Ô∏è Important: Command Purpose

**This command is a USER INTERFACE** - it delegates all actual work to the **architect agent**.

**What this command does:**
- ‚úÖ Parse user arguments
- ‚úÖ Validate input parameters
- ‚úÖ Delegate to architect agent with context
- ‚úÖ Display results to user

**What this command does NOT do:**
- ‚ùå Does NOT analyze code itself
- ‚ùå Does NOT validate architecture directly
- ‚ùå Does NOT generate reports itself

**All actual work is done by:** `.claude/agents/architect.md`

---

## Usage

```bash
# Full architectural review
/architect

# Backend-only review
/architect --scope=backend

# Critical findings only with GitHub issue creation
/architect --severity=critical --create-issues
```

---

## Workflow

### Step 1: Parse Arguments

```bash
# Extract arguments from command invocation
SCOPE="${1:-whole}"  # Default to whole
SEVERITY="${2:-all}"  # Default to all
CREATE_ISSUES=false

# Parse flags
for arg in "$@"; do
  case $arg in
    --scope=*)
      SCOPE="${arg#*=}"
      ;;
    --severity=*)
      SEVERITY="${arg#*=}"
      ;;
    --create-issues)
      CREATE_ISSUES=true
      ;;
  esac
done

# Validate scope
if [[ ! "$SCOPE" =~ ^(whole|backend|frontend|db)$ ]]; then
  echo "‚ùå Invalid scope: $SCOPE"
  echo "Valid options: whole, backend, frontend, db"
  exit 1
fi

# Validate severity
if [[ ! "$SCOPE" =~ ^(critical|all)$ ]]; then
  echo "‚ùå Invalid severity: $SEVERITY"
  echo "Valid options: critical, all"
  exit 1
fi
```

### Step 2: Prepare Context

```bash
echo "üèóÔ∏è  Architecture Review"
echo "======================"
echo "Scope: $SCOPE"
echo "Severity: $SEVERITY"
echo "Create Issues: $CREATE_ISSUES"
echo ""
```

### Step 3: Delegate to Architect Agent

Use natural language to describe the task for the architect agent:

```markdown
"I need comprehensive architectural validation from the architect specialist.

Review Request:
- **Scope**: $SCOPE (analyze entire codebase / backend only / frontend only / database only)
- **Severity Filter**: $SEVERITY (show all findings / only critical issues)
- **Issue Creation**: $CREATE_ISSUES (create GitHub issues for findings if true)

Focus Areas:
1. **VSA Compliance**: Validate Vertical Slice Architecture patterns
   - Feature organization (features/<domain>/)
   - Controller ‚Üí Service ‚Üí Repository flow
   - No cross-feature dependencies

2. **SOLID Principles**: Enforce design principles
   - Single Responsibility
   - Open/Closed
   - Liskov Substitution
   - Interface Segregation
   - Dependency Inversion

3. **Layer Boundaries**: Check proper separation
   - Controllers: HTTP handling only
   - Services: Business logic
   - Repositories: Data access
   - Entities: Data models
   - No layer violations

4. **Contract-First Development**:
   - TypeScript interfaces defined in @types before implementation
   - Clear contracts between layers
   - Type safety enforced

5. **DRY Analysis**: Identify code duplication
   - Duplicate logic across features
   - Opportunities for shared utilities
   - Extract common patterns

6. **Documentation Cross-Check**:
   - Compare documented architecture vs actual implementation
   - Identify documentation gaps
   - Flag architecture drift

7. **Database Review** (if scope includes db):
   - Migration safety
   - Schema consistency
   - Foreign key relationships
   - Index strategy

Expected Output:
- Comprehensive findings report grouped by severity
- Specific file/line references for each finding
- Actionable recommendations with examples
- Summary statistics (violations by category)
- Optionally create GitHub issues for tracking

Current Working Directory: $(pwd)
Project Root: $(git rev-parse --show-toplevel 2>/dev/null || pwd)"
```

### Step 4: Display Results

```bash
# The architect agent will provide comprehensive output
# This command simply ensures user sees the results

echo ""
echo "‚úÖ Architecture review complete"
echo ""
echo "üìÑ Report generated by architect agent"
echo "Review the findings above for architectural improvements"

if [ "$CREATE_ISSUES" = true ]; then
  echo ""
  echo "üìù GitHub issues created for tracking"
  echo "View issues: gh issue list --label=architecture"
fi
```

---

## Arguments

### `--scope=<value>`

Controls what part of the codebase to analyze:

- **whole** (default): Analyze entire codebase
- **backend**: Backend services only (services/api/)
- **frontend**: Frontend code only (services/web/)
- **db**: Database schema and migrations only

**Example**:
```bash
/architect --scope=backend
```

### `--severity=<value>`

Filter findings by severity level:

- **all** (default): Show all findings
- **critical**: Show only critical violations

**Example**:
```bash
/architect --severity=critical
```

### `--create-issues`

Flag to automatically create GitHub issues for findings:

**Example**:
```bash
/architect --create-issues
```

---

## Related Components

**Agents:**
- **architect.md** - The specialist agent that performs actual analysis (THIS COMMAND DELEGATES TO IT)
- **refactor.md** - For implementing architectural improvements
- **implementation.md** - For feature implementation following architecture

**Commands:**
- **/refactor** - Refactor code to address architectural findings
- **/audit** - Comprehensive quality audit (includes architecture)
- **/design-review** - UI/UX design review

---

## Success Criteria

- [x] Arguments parsed correctly
- [x] Delegation to architect agent successful
- [x] Findings displayed to user
- [x] Issues created if requested

---

## Notes

### Why This is a Thin Wrapper

In the 2025 agent-first architecture:

**Before** (old approach):
- Commands contained full implementation logic
- Duplication between commands and agents
- Hard to maintain consistency

**After** (modern approach):
- **Commands** = User interface (parse args, delegate, display)
- **Agents** = Workers (do actual analysis)
- **Benefits**: DRY, single source of truth, easier maintenance

### For Developers

If you need to modify architectural analysis logic:
- ‚ùå DON'T modify this command
- ‚úÖ DO modify `.claude/agents/architect.md`

This command is intentionally thin - all intelligence lives in the agent.

---

**Generated**: 2025-10-23 (Modernized to agent-first architecture)
**Delegates to**: `.claude/agents/architect.md`
**Type**: Thin wrapper command
